{% extends "layout.html" %}
{% from "schemas-pulldown.html" import create_schemas_pulldown %}
{% from "column-info.html" import create_column_info %}
{% from "actions.html" import create_actions %}
{% from "options.html" import create_options %}
{% from "query.html" import create_query %}
{% from "process-buttons.html" import create_process_buttons %}

{% block content %}
    <h3>Tabular (.tsv) files:</h3>
    <div class="form-group">
    <form id="events_form" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        {{ create_actions(assemble=True,generate_sidecar=True,validate=True,remodel=True,search=True,check_quality=True) }}
        {{ create_options(append_assembled=True,check_for_warnings=True,expand_defs=True,include_context=True,include_summaries=True,limit_errors=True,replace_defs=True,remove_types=True,show_details=True) }}

        <div class="card card-body bg-light my-5">
            <div class="row g-2 mb-2">
                <label for="events_file" class="col-sm-auto col-12 col-form-label form-label-col">Tabular (.tsv):</label>
                <div class="col-sm col-12">
                    <input class="form-control" type="file" id="events_file" name="events_file">
                </div>
            </div>
            <input type="hidden" id="has_column_names" name="has_column_names" value="on"/>
            <div class="mt-2">
                {{ create_column_info('show_events') }}
            </div>
            <div id="sidecar_input_section" class="mt-2">
                <div class="row g-2 mb-2">
                    <label for="sidecar_file" class="col-sm-auto col-12 col-form-label form-label-col">Sidecar (.json):</label>
                    <div class="col-sm col-12">
                        <input class="form-control" type="file" id="sidecar_file" name="sidecar_file">
                    </div>
                </div>
            </div>
            <div id="remodel_input_section" class="mt-3">
                <div class="row g-2 mb-2">
                    <label for="remodel_file" class="col-sm-auto col-12 col-form-label form-label-col">Remodel (.json):</label>
                    <div class="col-sm col-12">
                        <input class="form-control" type="file" id="remodel_file" name="remodel_file">
                    </div>
                </div>
            </div>
            <div class="mt-3">
                {{ create_query('HED query:') }}
            </div>
       
        </div>

        {{ create_schemas_pulldown() }}
        {{ create_process_buttons('events_submit', 'events_clear', 'events_flash') }}
    </form>
    </div>
    <script type="module">
        {%  include 'js/constants.js' %}
        {%  include 'js/column-info.js' %}
        {%  include 'js/form-helpers.js' %}
        {%  include 'js/schemas-pulldown.js' %}
        {%  include 'js/remodel-input.js' %}
        {%  include 'js/options.js' %}
        {%  include 'js/events-form.js' %}
    </script>

{% endblock %}

{% block widget_instructions %},
widgetInstructions: 'The user is on the HED Events tools page for validating, assembling, searching, and remodeling BIDS-style event files.'
{% endblock %}